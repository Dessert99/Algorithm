[https://school.programmers.co.kr/learn/courses/30/lessons/144856?language=mysql](https://school.programmers.co.kr/learn/courses/30/lessons/144856?language=mysql)
```sql
SELECT A.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY,
    -- 이제 여기에 매출액만 계산하면 된다.
    SUM(B.PRICE * S.SALES) AS TOTAL_SALES

FROM BOOK AS B
JOIN AUTHOR AS A ON B.AUTHOR_ID = A.AUTHOR_ID
JOIN BOOK_SALES AS S ON S.BOOK_ID = B.BOOK_ID
            
-- 2022년 1월 조건
WHERE S.SALES_DATE LIKE '2022-01%'

-- 저자 별, 카테고리 별
GROUP BY A.AUTHOR_ID, B.CATEGORY

ORDER BY A.AUTHOR_ID, B.CATEGORY DESC
```
### 🔗 풀이
1. 💡 핵심 문장
    - 2022년 1월의 도서 판매 데이터를 기준으로 저자 별, 카테고리 별 매출액(`TOTAL_SALES` = 판매량 * 판매가) 을 구하기

2. 🤔 우리가 해야 하는 것
    1. `BOOK_SALES` 테이블에서 2022년 1월 도서가 몇 권 판매되었느지 파악해야 한다.
    2. 저자 별, 카테고리 별로 그룹화 한다음, 매출액(공식 참고)을 구해야 한다.
    3. 이렇게 만든 테이블에서(3중 조인한) 저자ID, 저자명, 카테고리, 매출액 리스트를 출력한다.

3. 🤔 선택한 풀이법
    1. 3개의 테이블을 `JOIN`한다.
    2. `SELECT` 절에서 매출액을 계산한다.
        - 🤔 매출액은 어떻게 계산할까?
            1. 일단 저자 별, 카테고리 별로 그룹화했다.
            2. 매출액은 판매량과 판매가를 곱해야 한다.
            3. 판매량은 `S` 테이블에 있고, 판매가는 `B` 테이블에 있다.
            4. ⭐️ 지금 저자, 카테고리 별로 묶여있기 때문에, `SUM`으로 모든 행을 합쳐야 한다.

### 🔗 배운점
1. `SUM(B.PRICE * S.SALES) AS TOTAL_SALES` 부분 시각화
    1. 3개의 테이블을 `JOIN` 했을 때
        
        
        | **저자명 (AUTHOR_NAME)** | **카테고리 (CATEGORY)** | **책 제목** | **판매가 (B.PRICE)** | **1월 판매량 (S.SALES)** | **판매 날짜** |
        | --- | --- | --- | --- | --- | --- |
        | **홍길동** | **소설** | 홍길동전 1권 | 10,000 | **5** | 01-05 |
        | **홍길동** | **소설** | 홍길동전 2권 | 12,000 | **3** | 01-10 |
        | **홍길동** | **소설** | 홍길동전 1권 | 10,000 | **2** | 01-15 |
        | 김철수 | 경제 | 주식 바이블 | 20,000 | 10 | 01-12 |
    2. 매출액 계산
        
        
        | **저자명** | **카테고리** | **판매가** | **판매량** | **계산 결과 (B.PRICE * S.SALES)** |
        | --- | --- | --- | --- | --- |
        | 홍길동 | 소설 | 10,000 | 5 | **50,000 (1건의 매출)** |
        | 홍길동 | 소설 | 12,000 | 3 | **36,000 (1건의 매출)** |
        | 홍길동 | 소설 | 10,000 | 2 | **20,000 (1건의 매출)** |
    3. 그룹화 
        
        
        | **그룹 (바구니)** | **저자명** | **카테고리** | **바구니 안의 영수증들 (B.PRICE * S.SALES)** |
        | --- | --- | --- | --- |
        | **그룹 1** | **홍길동** | **소설** | 50,000 , 36,000 , 20,000 |
        | **그룹 2** | 김철수 | 경제 | 200,000 |
    4. `SUM`
        
        
        | **저자명 (A.AUTHOR_NAME)** | **카테고리 (B.CATEGORY)** | **TOTAL_SALES (SUM 결과)** |
        | --- | --- | --- |
        | **홍길동** | **소설** | **106,000** |
        | 김철수 | 경제 | 200,000 |
